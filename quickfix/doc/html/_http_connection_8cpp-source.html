<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>/home/orenmnero/autobuild/quickfix/src/C++/HttpConnection.cpp Source File</title>
<link href="quickfix.css" rel="stylesheet" type="text/css">
<table cellspacing="0" cellpadding="0" border="0">
  <tr>
   <td><img src="images/outsideTopLeft.gif"></td>
   <td width="100%" class="outsideTop">&nbsp;</td>
   <td><img src="images/outsideTopRight.gif"></td>
  </tr>
  <tr>
   <td class="outsideLeft">&nbsp;</td>
   <td>
	<img src="images/QuickFIX.jpg" align="middle" border=0>
	&nbsp;&nbsp;
	<a href="index.html">Index</a>&nbsp;
	<a href="files.html">Source Files</a>&nbsp;
	<a href="annotated.html">Annotated Class List</a>&nbsp;
	<a href="classes.html">Alphabetical Class List</a>&nbsp;
	<a href="hierarchy.html">Class Hierarchy</a>&nbsp;
	<a href="inherits.html">Graphical Class Hierarchy</a>&nbsp;
   </td>
   <td class="outsideRight">&nbsp;</td>
  </tr>
  <tr>
   <td><img src="images/outsideBottomLeft.gif"></td>
   <td width=100% class="outsideBottom">&nbsp;</td>
   <td><img src="images/outsideBottomRight.gif"></td>
  </tr>
</table>
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.3.6-20040222 -->
<h1>/home/orenmnero/autobuild/quickfix/src/C++/HttpConnection.cpp</h1><a href="_http_connection_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/****************************************************************************</span>
00002 <span class="comment">** Copyright (c) quickfixengine.org  All rights reserved.</span>
00003 <span class="comment">**</span>
00004 <span class="comment">** This file is part of the QuickFIX FIX Engine</span>
00005 <span class="comment">**</span>
00006 <span class="comment">** This file may be distributed under the terms of the quickfixengine.org</span>
00007 <span class="comment">** license as defined by quickfixengine.org and appearing in the file</span>
00008 <span class="comment">** LICENSE included in the packaging of this file.</span>
00009 <span class="comment">**</span>
00010 <span class="comment">** This file is provided AS IS with NO WARRANTY OF ANY KIND, INCLUDING THE</span>
00011 <span class="comment">** WARRANTY OF DESIGN, MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.</span>
00012 <span class="comment">**</span>
00013 <span class="comment">** See http://www.quickfixengine.org/LICENSE for licensing information.</span>
00014 <span class="comment">**</span>
00015 <span class="comment">** Contact ask@quickfixengine.org if any conditions of this licensing are</span>
00016 <span class="comment">** not clear to you.</span>
00017 <span class="comment">**</span>
00018 <span class="comment">****************************************************************************/</span>
00019 
00020 <span class="preprocessor">#ifdef _MSC_VER</span>
00021 <span class="preprocessor"></span><span class="preprocessor">#include "stdafx.h"</span>
00022 <span class="preprocessor">#else</span>
00023 <span class="preprocessor"></span><span class="preprocessor">#include "config.h"</span>
00024 <span class="preprocessor">#endif</span>
00025 <span class="preprocessor"></span><span class="preprocessor">#include "<a class="code" href="_call_stack_8h.html">CallStack.h</a>"</span>
00026 
00027 <span class="preprocessor">#include "<a class="code" href="_http_connection_8h.html">HttpConnection.h</a>"</span>
00028 <span class="preprocessor">#include "<a class="code" href="_http_message_8h.html">HttpMessage.h</a>"</span>
00029 <span class="preprocessor">#include "<a class="code" href="_session_8h.html">Session.h</a>"</span>
00030 <span class="preprocessor">#include "<a class="code" href="_utility_8h.html">Utility.h</a>"</span>
00031 
00032 <span class="keyword">namespace </span>FIX
00033 {
<a name="l00034"></a><a class="code" href="class_f_i_x_1_1_http_connection.html#a0">00034</a> HttpConnection::HttpConnection( <span class="keywordtype">int</span> s )
00035 : m_socket( s )
00036 {
00037   FD_ZERO( &amp;<a class="code" href="class_f_i_x_1_1_http_connection.html#r3">m_fds</a> );
00038   FD_SET( <a class="code" href="class_f_i_x_1_1_http_connection.html#r0">m_socket</a>, &amp;<a class="code" href="class_f_i_x_1_1_http_connection.html#r3">m_fds</a> );
00039 }
00040 
<a name="l00041"></a><a class="code" href="class_f_i_x_1_1_http_connection.html#d7">00041</a> <span class="keywordtype">bool</span> HttpConnection::send( <span class="keyword">const</span> std::string&amp; msg )
00042 { <a class="code" href="_call_stack_8h.html#a0">QF_STACK_PUSH</a>(HttpConnection::send)
00043   <span class="keywordflow">return</span> <a class="code" href="namespace_f_i_x.html#a2919">socket_send</a>( <a class="code" href="class_f_i_x_1_1_http_connection.html#r0">m_socket</a>, msg.c_str(), msg.length() ) &gt;= 0;
00044   <a class="code" href="_call_stack_8h.html#a1">QF_STACK_POP</a>
00045 }
00046 
<a name="l00047"></a><a class="code" href="class_f_i_x_1_1_http_connection.html#d8">00047</a> <span class="keywordtype">void</span> HttpConnection::disconnect( <span class="keywordtype">int</span> error )
00048 { <a class="code" href="_call_stack_8h.html#a0">QF_STACK_PUSH</a>(HttpConnection::disconnect)
00049   
00050   <span class="keywordflow">if</span>( error &gt; 0 )
00051     <a class="code" href="class_f_i_x_1_1_http_connection.html#d7">send</a>( HttpMessage::createResponse(error) );
00052 
00053   <a class="code" href="namespace_f_i_x.html#a2920">socket_close</a>( <a class="code" href="class_f_i_x_1_1_http_connection.html#r0">m_socket</a> );
00054 
00055   <a class="code" href="_call_stack_8h.html#a1">QF_STACK_POP</a>
00056 }
00057 
<a name="l00058"></a><a class="code" href="class_f_i_x_1_1_http_connection.html#a2">00058</a> <span class="keywordtype">bool</span> HttpConnection::read()
00059 { <a class="code" href="_call_stack_8h.html#a0">QF_STACK_PUSH</a>(HttpConnection::read)
00060 
00061   <span class="keyword">struct </span>timeval timeout = { 2, 0 };
00062   fd_set readset = <a class="code" href="class_f_i_x_1_1_http_connection.html#r3">m_fds</a>;
00063 
00064   <span class="keywordflow">try</span>
00065   {
00066     <span class="comment">// Wait for input (1 second timeout)</span>
00067     <span class="keywordtype">int</span> result = select( 1 + <a class="code" href="class_f_i_x_1_1_http_connection.html#r0">m_socket</a>, &amp;readset, 0, 0, &amp;timeout );
00068 
00069     <span class="keywordflow">if</span>( result &gt; 0 ) <span class="comment">// Something to read</span>
00070     {
00071       <span class="comment">// We can read without blocking</span>
00072       <span class="keywordtype">int</span> size = recv( <a class="code" href="class_f_i_x_1_1_http_connection.html#r0">m_socket</a>, <a class="code" href="class_f_i_x_1_1_http_connection.html#r1">m_buffer</a>, <span class="keyword">sizeof</span>(<a class="code" href="class_f_i_x_1_1_http_connection.html#r1">m_buffer</a>), 0 );
00073       <span class="keywordflow">if</span> ( size &lt;= 0 ) { <span class="keywordflow">throw</span> <a class="code" href="struct_f_i_x_1_1_socket_recv_failed.html">SocketRecvFailed</a>( size ); }
00074       <a class="code" href="class_f_i_x_1_1_http_connection.html#r2">m_parser</a>.<a class="code" href="class_f_i_x_1_1_http_parser.html#a3">addToStream</a>( m_buffer, size );
00075     }
00076     <span class="keywordflow">else</span> <span class="keywordflow">if</span>( result == 0 ) <span class="comment">// Timeout</span>
00077     {
00078       <a class="code" href="class_f_i_x_1_1_http_connection.html#d8">disconnect</a>( 408 );
00079       <span class="keywordflow">return</span> <span class="keyword">false</span>;
00080     }
00081     <span class="keywordflow">else</span> <span class="keywordflow">if</span>( result &lt; 0 ) <span class="comment">// Error</span>
00082     {
00083       <span class="keywordflow">throw</span> <a class="code" href="struct_f_i_x_1_1_socket_recv_failed.html">SocketRecvFailed</a>( result );
00084     }
00085 
00086     <a class="code" href="class_f_i_x_1_1_http_connection.html#d1">processStream</a>();
00087     <span class="keywordflow">return</span> <span class="keyword">true</span>;
00088   }
00089   <span class="keywordflow">catch</span> ( <a class="code" href="struct_f_i_x_1_1_socket_recv_failed.html">SocketRecvFailed</a>&amp; )
00090   {
00091     <a class="code" href="class_f_i_x_1_1_http_connection.html#d8">disconnect</a>();
00092     <span class="keywordflow">return</span> <span class="keyword">false</span>;
00093   }
00094 
00095   <a class="code" href="_call_stack_8h.html#a1">QF_STACK_POP</a>
00096 }
00097 
<a name="l00098"></a><a class="code" href="class_f_i_x_1_1_http_connection.html#d0">00098</a> <span class="keywordtype">bool</span> HttpConnection::readMessage( std::string&amp; msg )
00099 <span class="keywordflow">throw</span>( <a class="code" href="struct_f_i_x_1_1_socket_recv_failed.html">SocketRecvFailed</a> )
00100 { <a class="code" href="_call_stack_8h.html#a0">QF_STACK_PUSH</a>(HttpConnection::readMessage)
00101 
00102   <span class="keywordflow">try</span>
00103   {
00104     <span class="keywordflow">return</span> m_parser.readHttpMessage( msg );
00105   }
00106   <span class="keywordflow">catch</span> ( <a class="code" href="struct_f_i_x_1_1_message_parse_error.html">MessageParseError</a>&amp; ) 
00107   { 
00108     disconnect( 400 );
00109   }
00110   <span class="keywordflow">return</span> <span class="keyword">true</span>;
00111 
00112   <a class="code" href="_call_stack_8h.html#a1">QF_STACK_POP</a>
00113 }
00114 
<a name="l00115"></a><a class="code" href="class_f_i_x_1_1_http_connection.html#d1">00115</a> <span class="keywordtype">void</span> HttpConnection::processStream()
00116 { <a class="code" href="_call_stack_8h.html#a0">QF_STACK_PUSH</a>(HttpConnection::processStream)
00117 
00118   std::string msg;
00119   <span class="keywordflow">try</span>
00120   {
00121     <span class="keywordflow">if</span>( !<a class="code" href="class_f_i_x_1_1_http_connection.html#d0">readMessage</a>(msg) )
00122       <span class="keywordflow">return</span>;
00123     <a class="code" href="class_f_i_x_1_1_http_message.html">HttpMessage</a> request( msg );
00124     <a class="code" href="class_f_i_x_1_1_http_connection.html#d2">processRequest</a>( request );
00125   }
00126   <span class="keywordflow">catch</span>( <a class="code" href="struct_f_i_x_1_1_invalid_message.html">InvalidMessage</a>&amp; ) 
00127   {
00128     <a class="code" href="class_f_i_x_1_1_http_connection.html#d8">disconnect</a>( 400 );
00129     <span class="keywordflow">return</span>;
00130   }
00131 
00132   <span class="keywordflow">return</span>;
00133 
00134   <a class="code" href="_call_stack_8h.html#a1">QF_STACK_POP</a>
00135 }
00136 
<a name="l00137"></a><a class="code" href="class_f_i_x_1_1_http_connection.html#d2">00137</a> <span class="keywordtype">void</span> HttpConnection::processRequest( <span class="keyword">const</span> <a class="code" href="class_f_i_x_1_1_http_message.html">HttpMessage</a>&amp; request )
00138 { <a class="code" href="_call_stack_8h.html#a0">QF_STACK_PUSH</a>(HttpConnection::processRequest)
00139 
00140   <span class="keywordtype">int</span> error = 200;
00141   std::stringstream header;
00142   std::stringstream body;
00143   std::string title = <span class="stringliteral">"QuickFIX Engine Web Interface"</span>;
00144 
00145   header &lt;&lt; <span class="stringliteral">"&lt;HEAD&gt;&lt;CENTER&gt;&lt;TITLE&gt;"</span> &lt;&lt; title &lt;&lt; <span class="stringliteral">"&lt;/TITLE&gt;&lt;H1&gt;"</span> &lt;&lt; title &lt;&lt; <span class="stringliteral">"&lt;/H1&gt;&lt;/CENTER&gt;"</span>
00146          &lt;&lt; <span class="stringliteral">"&lt;CENTER&gt;[&lt;A HREF='/'&gt;HOME&lt;/A&gt;]"</span>
00147          &lt;&lt; <span class="stringliteral">"&amp;nbsp;[&lt;A HREF='"</span> &lt;&lt; request.<a class="code" href="class_f_i_x_1_1_http_message.html#a3">toString</a>() &lt;&lt; <span class="stringliteral">"'&gt;REFRESH&lt;/A&gt;]"</span>
00148          &lt;&lt; <span class="stringliteral">"&lt;/CENTER&gt;&lt;HR/&gt;"</span>;
00149   body &lt;&lt; <span class="stringliteral">"&lt;BODY&gt;"</span>;
00150 
00151   <span class="keywordflow">try</span>
00152   {
00153     <span class="keywordflow">if</span>( request.<a class="code" href="class_f_i_x_1_1_http_message.html#a7">getRootString</a>() == <span class="stringliteral">"/"</span> )
00154       <a class="code" href="class_f_i_x_1_1_http_connection.html#d3">processRoot</a>( request, header, body );
00155     <span class="keywordflow">else</span> <span class="keywordflow">if</span>( request.<a class="code" href="class_f_i_x_1_1_http_message.html#a7">getRootString</a>() == <span class="stringliteral">"/session"</span> )
00156       <a class="code" href="class_f_i_x_1_1_http_connection.html#d4">processSession</a>( request, header, body );
00157     <span class="keywordflow">else</span> <span class="keywordflow">if</span>( request.<a class="code" href="class_f_i_x_1_1_http_message.html#a7">getRootString</a>() == <span class="stringliteral">"/resetSession"</span> )
00158       <a class="code" href="class_f_i_x_1_1_http_connection.html#d5">processResetSession</a>( request, header, body );
00159     <span class="keywordflow">else</span> <span class="keywordflow">if</span>( request.<a class="code" href="class_f_i_x_1_1_http_message.html#a7">getRootString</a>() == <span class="stringliteral">"/refreshSession"</span> )
00160       <a class="code" href="class_f_i_x_1_1_http_connection.html#d6">processRefreshSession</a>( request, header, body );
00161     <span class="keywordflow">else</span>
00162       error = 404;
00163   }
00164   <span class="keywordflow">catch</span>( std::exception&amp; e )
00165   {
00166     error = 400;
00167     body &lt;&lt; e.what();
00168   }
00169 
00170   header &lt;&lt; <span class="stringliteral">"&lt;/HEADER&gt;"</span>;
00171   body &lt;&lt; <span class="stringliteral">"&lt;/BODY&gt;"</span>;
00172 
00173   std::string response = <span class="stringliteral">"&lt;HTML&gt;"</span> + header.str() + body.str() + <span class="stringliteral">"&lt;/HTML&gt;"</span>;
00174   <a class="code" href="class_f_i_x_1_1_http_connection.html#d7">send</a>( HttpMessage::createResponse(error, error == 200 ? response : <span class="stringliteral">""</span>) );
00175 
00176   <a class="code" href="class_f_i_x_1_1_http_connection.html#d8">disconnect</a>();
00177 
00178   <a class="code" href="_call_stack_8h.html#a1">QF_STACK_POP</a>
00179 }
00180 
00181 <span class="keywordtype">void</span> HttpConnection::processRoot
<a name="l00182"></a><a class="code" href="class_f_i_x_1_1_http_connection.html#d3">00182</a> ( <span class="keyword">const</span> <a class="code" href="class_f_i_x_1_1_http_message.html">HttpMessage</a>&amp; request, std::stringstream&amp; header, std::stringstream&amp; body )
00183 { <a class="code" href="_call_stack_8h.html#a0">QF_STACK_PUSH</a>(HttpConnection::processRoot)
00184 
00185   body &lt;&lt; <span class="stringliteral">"&lt;TABLE border='1' cellspacing='2' width='100%'&gt;"</span>
00186        &lt;&lt; <span class="stringliteral">"&lt;CAPTION&gt;&lt;EM&gt;"</span> &lt;&lt; Session::numSessions() &lt;&lt; <span class="stringliteral">" Sessions managed by QuickFIX&lt;/EM&gt;&lt;/CAPTION&gt;"</span>
00187        &lt;&lt; <span class="stringliteral">"&lt;TR&gt;"</span>
00188        &lt;&lt; <span class="stringliteral">"&lt;TD align='center'&gt;Session&lt;/TD&gt;"</span>
00189        &lt;&lt; <span class="stringliteral">"&lt;TD align='center'&gt;Type&lt;/TD&gt;"</span>
00190        &lt;&lt; <span class="stringliteral">"&lt;TD align='center'&gt;Enabled&lt;/TD&gt;"</span>
00191        &lt;&lt; <span class="stringliteral">"&lt;TD align='center'&gt;Session Time&lt;/TD&gt;"</span>
00192        &lt;&lt; <span class="stringliteral">"&lt;TD align='center'&gt;Logged On&lt;/TD&gt;"</span>
00193        &lt;&lt; <span class="stringliteral">"&lt;TD align='center'&gt;Next Incoming&lt;/TD&gt;"</span>
00194        &lt;&lt; <span class="stringliteral">"&lt;TD align='center'&gt;Next Outgoing&lt;/TD&gt;"</span>
00195        &lt;&lt; <span class="stringliteral">"&lt;/TR&gt;"</span>;
00196 
00197   std::set&lt;SessionID&gt; sessions = Session::getSessions();
00198   std::set&lt;SessionID&gt;::iterator i;
00199   <span class="keywordflow">for</span>( i = sessions.begin(); i != sessions.end(); ++i )
00200   {
00201     <a class="code" href="class_f_i_x_1_1_session.html">Session</a>* pSession = Session::lookupSession( *i );
00202     <span class="keywordflow">if</span>( !pSession ) <span class="keywordflow">continue</span>;
00203 
00204     body &lt;&lt; <span class="stringliteral">"&lt;TR&gt;"</span>
00205          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;&lt;A href=/session?BeginString="</span> &lt;&lt; i-&gt;getBeginString()
00206                             &lt;&lt; <span class="stringliteral">"&amp;SenderCompID="</span> &lt;&lt; i-&gt;getSenderCompID()
00207                             &lt;&lt; <span class="stringliteral">"&amp;TargetCompID="</span> &lt;&lt; i-&gt;getTargetCompID();
00208     <span class="keywordflow">if</span>( i-&gt;getSessionQualifier().size() )
00209       body &lt;&lt; <span class="stringliteral">"&amp;SessionQualifier="</span> &lt;&lt; i-&gt;getSessionQualifier();
00210 
00211     body &lt;&lt; <span class="stringliteral">"&gt;"</span> &lt;&lt; *i &lt;&lt; <span class="stringliteral">"&lt;/A&gt;&lt;/TD&gt;"</span>
00212          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;"</span> &lt;&lt; (pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a17">isInitiator</a>() ? <span class="stringliteral">"initiator"</span> : <span class="stringliteral">"acceptor"</span>) &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00213          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;"</span> &lt;&lt; (pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a4">isEnabled</a>() ? <span class="stringliteral">"yes"</span> : <span class="stringliteral">"no"</span>) &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00214          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;"</span> &lt;&lt; (pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a16">isSessionTime</a>() ? <span class="stringliteral">"yes"</span> : <span class="stringliteral">"no"</span>) &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00215          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;"</span> &lt;&lt; (pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a8">isLoggedOn</a>() ? <span class="stringliteral">"yes"</span> : <span class="stringliteral">"no"</span>) &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00216          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;"</span> &lt;&lt; pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a50">getExpectedTargetNum</a>() &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00217          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;"</span> &lt;&lt; pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a49">getExpectedSenderNum</a>() &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00218          &lt;&lt; <span class="stringliteral">"&lt;/TR&gt;"</span>;
00219   }
00220 
00221   body &lt;&lt; <span class="stringliteral">"&lt;/TABLE&gt;"</span>;
00222 
00223   <a class="code" href="_call_stack_8h.html#a1">QF_STACK_POP</a>
00224 }
00225 
00226 <span class="keywordtype">void</span> HttpConnection::processSession
<a name="l00227"></a><a class="code" href="class_f_i_x_1_1_http_connection.html#d4">00227</a> ( <span class="keyword">const</span> <a class="code" href="class_f_i_x_1_1_http_message.html">HttpMessage</a>&amp; request, std::stringstream&amp; header, std::stringstream&amp; body )
00228 { <a class="code" href="_call_stack_8h.html#a0">QF_STACK_PUSH</a>(HttpConnection::processSession)
00229 
00230   <span class="keywordflow">try</span>
00231   {
00232     <a class="code" href="class_f_i_x_1_1_http_message.html">HttpMessage</a> copy = request;
00233     std::string url = request.<a class="code" href="class_f_i_x_1_1_http_message.html#a3">toString</a>();
00234     std::string beginString = copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a11">getParameter</a>( <span class="stringliteral">"BeginString"</span> );
00235     std::string senderCompID = copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a11">getParameter</a>( <span class="stringliteral">"SenderCompID"</span> );
00236     std::string targetCompID = copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a11">getParameter</a>( <span class="stringliteral">"TargetCompID"</span> );
00237     std::string sessionQualifier;
00238         <span class="keywordflow">if</span>( copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a10">hasParameter</a>(<span class="stringliteral">"SessionQualifier"</span>) )
00239                 sessionQualifier = copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a11">getParameter</a>( <span class="stringliteral">"SessionQualifier"</span> );
00240 
00241     <a class="code" href="class_f_i_x_1_1_session_i_d.html">SessionID</a> sessionID( beginString, senderCompID, targetCompID, sessionQualifier );
00242     <a class="code" href="class_f_i_x_1_1_session.html">Session</a>* pSession = Session::lookupSession( sessionID );
00243     <span class="keywordflow">if</span>( pSession == 0 ) <span class="keywordflow">throw</span> <a class="code" href="struct_f_i_x_1_1_session_not_found.html">SessionNotFound</a>();
00244 
00245     <span class="keywordflow">if</span>( copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a10">hasParameter</a>(<span class="stringliteral">"Enabled"</span>) )
00246     {
00247       IntConvertor::convert(copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a11">getParameter</a>(<span class="stringliteral">"Enabled"</span>)) ? pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a2">logon</a>() : pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a3">logout</a>();
00248       copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a13">removeParameter</a>(<span class="stringliteral">"Enabled"</span>);
00249     }
00250     <span class="keywordflow">if</span>( copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a10">hasParameter</a>(<a class="code" href="namespace_f_i_x.html#a164">SEND_REDUNDANT_RESENDREQUESTS</a>) )
00251     {
00252       pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a20">setSendRedundantResendRequests</a>( IntConvertor::convert(copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a11">getParameter</a>(<a class="code" href="namespace_f_i_x.html#a164">SEND_REDUNDANT_RESENDREQUESTS</a>)) != 0 );
00253       copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a13">removeParameter</a>(<a class="code" href="namespace_f_i_x.html#a164">SEND_REDUNDANT_RESENDREQUESTS</a>);
00254     }
00255     <span class="keywordflow">if</span>( copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a10">hasParameter</a>(<a class="code" href="namespace_f_i_x.html#a170">CHECK_COMPID</a>) )
00256     {
00257       pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a22">setCheckCompId</a>( IntConvertor::convert(copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a11">getParameter</a>(<a class="code" href="namespace_f_i_x.html#a170">CHECK_COMPID</a>)) != 0 );
00258       copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a13">removeParameter</a>(<a class="code" href="namespace_f_i_x.html#a170">CHECK_COMPID</a>);
00259     }
00260     <span class="keywordflow">if</span>( copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a10">hasParameter</a>(<a class="code" href="namespace_f_i_x.html#a171">CHECK_LATENCY</a>) )
00261     {
00262       pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a24">setCheckLatency</a>( IntConvertor::convert(copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a11">getParameter</a>(<a class="code" href="namespace_f_i_x.html#a171">CHECK_LATENCY</a>)) != 0 );
00263       copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a13">removeParameter</a>(<a class="code" href="namespace_f_i_x.html#a171">CHECK_LATENCY</a>);
00264     }
00265     <span class="keywordflow">if</span>( copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a10">hasParameter</a>(<a class="code" href="namespace_f_i_x.html#a220">RESET_ON_LOGON</a>) )
00266     {
00267       pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a32">setResetOnLogon</a>( IntConvertor::convert(copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a11">getParameter</a>(<a class="code" href="namespace_f_i_x.html#a220">RESET_ON_LOGON</a>)) != 0 );
00268       copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a13">removeParameter</a>(<a class="code" href="namespace_f_i_x.html#a220">RESET_ON_LOGON</a>);
00269     }
00270     <span class="keywordflow">if</span>( copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a10">hasParameter</a>(<a class="code" href="namespace_f_i_x.html#a221">RESET_ON_LOGOUT</a>) )
00271     {
00272       pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a34">setResetOnLogout</a>( IntConvertor::convert(copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a11">getParameter</a>(<a class="code" href="namespace_f_i_x.html#a221">RESET_ON_LOGOUT</a>)) != 0 );
00273       copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a13">removeParameter</a>(<a class="code" href="namespace_f_i_x.html#a221">RESET_ON_LOGOUT</a>);
00274     }
00275     <span class="keywordflow">if</span>( copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a10">hasParameter</a>(<a class="code" href="namespace_f_i_x.html#a222">RESET_ON_DISCONNECT</a>) )
00276     {
00277       pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a36">setResetOnDisconnect</a>( IntConvertor::convert(copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a11">getParameter</a>(<a class="code" href="namespace_f_i_x.html#a222">RESET_ON_DISCONNECT</a>)) != 0 );
00278       copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a13">removeParameter</a>(<a class="code" href="namespace_f_i_x.html#a222">RESET_ON_DISCONNECT</a>);
00279     }
00280     <span class="keywordflow">if</span>( copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a10">hasParameter</a>(<a class="code" href="namespace_f_i_x.html#a223">REFRESH_ON_LOGON</a>) )
00281     {
00282       pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a38">setRefreshOnLogon</a>( IntConvertor::convert(copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a11">getParameter</a>(<a class="code" href="namespace_f_i_x.html#a223">REFRESH_ON_LOGON</a>)) != 0 );
00283       copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a13">removeParameter</a>(<a class="code" href="namespace_f_i_x.html#a223">REFRESH_ON_LOGON</a>);
00284     }
00285     <span class="keywordflow">if</span>( copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a10">hasParameter</a>(<a class="code" href="namespace_f_i_x.html#a224">MILLISECONDS_IN_TIMESTAMP</a>) )
00286     {
00287       pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a40">setMillisecondsInTimeStamp</a>( IntConvertor::convert(copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a11">getParameter</a>(<a class="code" href="namespace_f_i_x.html#a224">MILLISECONDS_IN_TIMESTAMP</a>)) != 0 );
00288       copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a13">removeParameter</a>(<a class="code" href="namespace_f_i_x.html#a224">MILLISECONDS_IN_TIMESTAMP</a>);
00289     }
00290     <span class="keywordflow">if</span>( copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a10">hasParameter</a>(<a class="code" href="namespace_f_i_x.html#a226">PERSIST_MESSAGES</a>) )
00291     {
00292       pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a42">setPersistMessages</a>( IntConvertor::convert(copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a11">getParameter</a>(<a class="code" href="namespace_f_i_x.html#a226">PERSIST_MESSAGES</a>)) != 0 );
00293       copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a13">removeParameter</a>(<a class="code" href="namespace_f_i_x.html#a226">PERSIST_MESSAGES</a>);
00294     }
00295 
00296     <span class="keywordflow">if</span>( url != copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a3">toString</a>() )
00297       header &lt;&lt; <span class="stringliteral">"&lt;META http-equiv='refresh' content=0;URL='"</span> &lt;&lt; copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a3">toString</a>() &lt;&lt; <span class="stringliteral">"'&gt;"</span>;
00298 
00299     body &lt;&lt; <span class="stringliteral">"&lt;TABLE border='1' cellspacing='2' width='100%'&gt;"</span>
00300          &lt;&lt; <span class="stringliteral">"&lt;CAPTION&gt;&lt;EM&gt;"</span> &lt;&lt; sessionID 
00301          &lt;&lt; <span class="stringliteral">"&amp;nbsp;(&lt;A href='/resetSession"</span> &lt;&lt; copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a8">getParameterString</a>() &lt;&lt; <span class="stringliteral">"'&gt;RESET&lt;/A&gt;)"</span>
00302          &lt;&lt; <span class="stringliteral">"&amp;nbsp;(&lt;A href='/refreshSession"</span> &lt;&lt; copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a8">getParameterString</a>() &lt;&lt; <span class="stringliteral">"'&gt;REFRESH&lt;/A&gt;)"</span>
00303          &lt;&lt; <span class="stringliteral">"&lt;/EM&gt;&lt;/CAPTION&gt;"</span>
00304          &lt;&lt; <span class="stringliteral">"&lt;TR&gt;&lt;TD&gt;Enabled&lt;/TD&gt;&lt;TD&gt;"</span> 
00305          &lt;&lt; (pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a4">isEnabled</a>() ? <span class="stringliteral">"yes"</span> : <span class="stringliteral">"no"</span>) &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00306          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;&lt;A href='"</span> &lt;&lt; url + <span class="stringliteral">"&amp;Enabled="</span> &lt;&lt; !pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a4">isEnabled</a>() &lt;&lt; <span class="stringliteral">"'&gt;"</span> &lt;&lt; <span class="stringliteral">"[toggle]&lt;/A&gt;&lt;/TD&gt;&lt;/TR&gt;"</span> 
00307          &lt;&lt; <span class="stringliteral">"&lt;TR&gt;&lt;TD&gt;Type&lt;/TD&gt;&lt;TD&gt;"</span> 
00308          &lt;&lt; (pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a17">isInitiator</a>() ? <span class="stringliteral">"initiator"</span> : <span class="stringliteral">"acceptor"</span>) &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;&lt;/TR&gt;"</span>
00309          &lt;&lt; <span class="stringliteral">"&lt;TR&gt;&lt;TD&gt;Session Time&lt;/TD&gt;&lt;TD&gt;"</span> 
00310          &lt;&lt; (pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a16">isSessionTime</a>() ? <span class="stringliteral">"yes"</span> : <span class="stringliteral">"no"</span>) &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;&lt;/TR&gt;"</span>
00311          &lt;&lt; <span class="stringliteral">"&lt;TR&gt;&lt;TD&gt;Logged On&lt;/TD&gt;&lt;TD&gt;"</span> 
00312          &lt;&lt; (pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a8">isLoggedOn</a>() ? <span class="stringliteral">"yes"</span> : <span class="stringliteral">"no"</span>) &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;&lt;/TR&gt;"</span>
00313          &lt;&lt; <span class="stringliteral">"&lt;TR&gt;&lt;TD&gt;Next Incoming&lt;/TD&gt;&lt;TD&gt;"</span> 
00314          &lt;&lt; pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a50">getExpectedTargetNum</a>() &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;&lt;/TR&gt;"</span>
00315          &lt;&lt; <span class="stringliteral">"&lt;TR&gt;&lt;TD&gt;Next Outgoing&lt;/TD&gt;&lt;TD&gt;"</span> 
00316          &lt;&lt; pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a49">getExpectedSenderNum</a>() &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;&lt;/TR&gt;"</span>
00317          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;"</span> &lt;&lt; <a class="code" href="namespace_f_i_x.html#a164">SEND_REDUNDANT_RESENDREQUESTS</a> &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00318          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;"</span> &lt;&lt; (pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a19">getSendRedundantResendRequests</a>() ? <span class="stringliteral">"yes"</span> : <span class="stringliteral">"no"</span>) &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00319          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;&lt;A href='"</span> &lt;&lt; url &lt;&lt; <span class="stringliteral">"&amp;"</span> &lt;&lt; <a class="code" href="namespace_f_i_x.html#a164">SEND_REDUNDANT_RESENDREQUESTS</a> &lt;&lt; <span class="stringliteral">"="</span> &lt;&lt; !pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a19">getSendRedundantResendRequests</a>() &lt;&lt; <span class="stringliteral">"'&gt;"</span> &lt;&lt; <span class="stringliteral">"[toggle]&lt;/A&gt;&lt;/TD&gt;&lt;/TR&gt;"</span>
00320          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;"</span> &lt;&lt; <a class="code" href="namespace_f_i_x.html#a170">CHECK_COMPID</a> &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00321          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;"</span> &lt;&lt; (pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a21">getCheckCompId</a>() ? <span class="stringliteral">"yes"</span> : <span class="stringliteral">"no"</span>) &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00322          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;&lt;A href='"</span> &lt;&lt; url &lt;&lt; <span class="stringliteral">"&amp;"</span> &lt;&lt; <a class="code" href="namespace_f_i_x.html#a170">CHECK_COMPID</a> &lt;&lt; <span class="stringliteral">"="</span> &lt;&lt; !pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a21">getCheckCompId</a>() &lt;&lt; <span class="stringliteral">"'&gt;"</span> &lt;&lt; <span class="stringliteral">"[toggle]&lt;/A&gt;&lt;/TD&gt;&lt;/TR&gt;"</span> 
00323          &lt;&lt; <span class="stringliteral">"&lt;TR&gt;&lt;TD&gt;"</span> &lt;&lt; <a class="code" href="namespace_f_i_x.html#a171">CHECK_LATENCY</a> &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00324          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;"</span> &lt;&lt; (pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a23">getCheckLatency</a>() ? <span class="stringliteral">"yes"</span> : <span class="stringliteral">"no"</span>) &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00325          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;&lt;A href='"</span> &lt;&lt; url &lt;&lt; <span class="stringliteral">"&amp;"</span> &lt;&lt; <a class="code" href="namespace_f_i_x.html#a171">CHECK_LATENCY</a> &lt;&lt; <span class="stringliteral">"="</span> &lt;&lt; !pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a23">getCheckLatency</a>() &lt;&lt; <span class="stringliteral">"'&gt;"</span> &lt;&lt; <span class="stringliteral">"[toggle]&lt;/A&gt;&lt;/TD&gt;&lt;/TR&gt;"</span>
00326          &lt;&lt; <span class="stringliteral">"&lt;TR&gt;&lt;TD&gt;"</span> &lt;&lt; <a class="code" href="namespace_f_i_x.html#a172">MAX_LATENCY</a> &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00327          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;"</span> &lt;&lt; pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a25">getMaxLatency</a>() &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;&lt;/TR&gt;"</span>
00328          &lt;&lt; <span class="stringliteral">"&lt;TR&gt;&lt;TD&gt;"</span> &lt;&lt; <a class="code" href="namespace_f_i_x.html#a183">LOGON_TIMEOUT</a> &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00329          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;"</span> &lt;&lt; pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a27">getLogonTimeout</a>() &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;&lt;/TR&gt;"</span>
00330          &lt;&lt; <span class="stringliteral">"&lt;TR&gt;&lt;TD&gt;"</span> &lt;&lt; <a class="code" href="namespace_f_i_x.html#a184">LOGOUT_TIMEOUT</a> &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00331          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;"</span> &lt;&lt; pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a29">getLogoutTimeout</a>() &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;&lt;/TR&gt;"</span>
00332          &lt;&lt; <span class="stringliteral">"&lt;TR&gt;&lt;TD&gt;"</span> &lt;&lt; <a class="code" href="namespace_f_i_x.html#a220">RESET_ON_LOGON</a> &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00333          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;"</span> &lt;&lt; (pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a31">getResetOnLogon</a>() ? <span class="stringliteral">"yes"</span> : <span class="stringliteral">"no"</span>) &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00334          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;&lt;A href='"</span> &lt;&lt; url &lt;&lt; <span class="stringliteral">"&amp;"</span> &lt;&lt; <a class="code" href="namespace_f_i_x.html#a220">RESET_ON_LOGON</a> &lt;&lt; <span class="stringliteral">"="</span> &lt;&lt; !pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a31">getResetOnLogon</a>() &lt;&lt; <span class="stringliteral">"'&gt;"</span> &lt;&lt; <span class="stringliteral">"[toggle]&lt;/A&gt;&lt;/TD&gt;&lt;/TR&gt;"</span>
00335          &lt;&lt; <span class="stringliteral">"&lt;TR&gt;&lt;TD&gt;"</span> &lt;&lt; <a class="code" href="namespace_f_i_x.html#a221">RESET_ON_LOGOUT</a> &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00336          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;"</span> &lt;&lt; (pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a33">getResetOnLogout</a>() ? <span class="stringliteral">"yes"</span> : <span class="stringliteral">"no"</span>) &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00337          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;&lt;A href='"</span> &lt;&lt; url &lt;&lt; <span class="stringliteral">"&amp;"</span> &lt;&lt; <a class="code" href="namespace_f_i_x.html#a221">RESET_ON_LOGOUT</a> &lt;&lt; <span class="stringliteral">"="</span> &lt;&lt; !pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a33">getResetOnLogout</a>() &lt;&lt; <span class="stringliteral">"'&gt;"</span> &lt;&lt; <span class="stringliteral">"[toggle]&lt;/A&gt;&lt;/TD&gt;&lt;/TR&gt;"</span>
00338          &lt;&lt; <span class="stringliteral">"&lt;TR&gt;&lt;TD&gt;"</span> &lt;&lt; <a class="code" href="namespace_f_i_x.html#a222">RESET_ON_DISCONNECT</a> &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00339          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;"</span> &lt;&lt; (pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a35">getResetOnDisconnect</a>() ? <span class="stringliteral">"yes"</span> : <span class="stringliteral">"no"</span>) &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00340          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;&lt;A href='"</span> &lt;&lt; url &lt;&lt; <span class="stringliteral">"&amp;"</span> &lt;&lt; <a class="code" href="namespace_f_i_x.html#a222">RESET_ON_DISCONNECT</a> &lt;&lt; <span class="stringliteral">"="</span> &lt;&lt; !pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a35">getResetOnDisconnect</a>() &lt;&lt; <span class="stringliteral">"'&gt;"</span> &lt;&lt; <span class="stringliteral">"[toggle]&lt;/A&gt;&lt;/TD&gt;&lt;/TR&gt;"</span>
00341          &lt;&lt; <span class="stringliteral">"&lt;TR&gt;&lt;TD&gt;"</span> &lt;&lt; <a class="code" href="namespace_f_i_x.html#a223">REFRESH_ON_LOGON</a> &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00342          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;"</span> &lt;&lt; (pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a37">getRefreshOnLogon</a>() ? <span class="stringliteral">"yes"</span> : <span class="stringliteral">"no"</span>) &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00343          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;&lt;A href='"</span> &lt;&lt; url &lt;&lt; <span class="stringliteral">"&amp;"</span> &lt;&lt; <a class="code" href="namespace_f_i_x.html#a223">REFRESH_ON_LOGON</a> &lt;&lt; <span class="stringliteral">"="</span> &lt;&lt; !pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a37">getRefreshOnLogon</a>() &lt;&lt; <span class="stringliteral">"'&gt;"</span> &lt;&lt; <span class="stringliteral">"[toggle]&lt;/A&gt;&lt;/TD&gt;&lt;/TR&gt;"</span>
00344          &lt;&lt; <span class="stringliteral">"&lt;TR&gt;&lt;TD&gt;"</span> &lt;&lt; <a class="code" href="namespace_f_i_x.html#a224">MILLISECONDS_IN_TIMESTAMP</a> &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00345          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;"</span> &lt;&lt; (pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a39">getMillisecondsInTimeStamp</a>() ? <span class="stringliteral">"yes"</span> : <span class="stringliteral">"no"</span>) &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00346          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;&lt;A href='"</span> &lt;&lt; url &lt;&lt; <span class="stringliteral">"&amp;"</span> &lt;&lt; <a class="code" href="namespace_f_i_x.html#a224">MILLISECONDS_IN_TIMESTAMP</a> &lt;&lt; <span class="stringliteral">"="</span> &lt;&lt; !pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a39">getMillisecondsInTimeStamp</a>() &lt;&lt; <span class="stringliteral">"'&gt;"</span> &lt;&lt; <span class="stringliteral">"[toggle]&lt;/A&gt;&lt;/TD&gt;&lt;/TR&gt;"</span>
00347          &lt;&lt; <span class="stringliteral">"&lt;TR&gt;&lt;TD&gt;"</span> &lt;&lt; <a class="code" href="namespace_f_i_x.html#a226">PERSIST_MESSAGES</a> &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00348          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;"</span> &lt;&lt; (pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a41">getPersistMessages</a>() ? <span class="stringliteral">"yes"</span> : <span class="stringliteral">"no"</span>) &lt;&lt; <span class="stringliteral">"&lt;/TD&gt;"</span>
00349          &lt;&lt; <span class="stringliteral">"&lt;TD&gt;&lt;A href='"</span> &lt;&lt; url &lt;&lt; <span class="stringliteral">"&amp;"</span> &lt;&lt; <a class="code" href="namespace_f_i_x.html#a226">PERSIST_MESSAGES</a> &lt;&lt; <span class="stringliteral">"="</span> &lt;&lt; !pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a41">getPersistMessages</a>() &lt;&lt; <span class="stringliteral">"'&gt;"</span> &lt;&lt; <span class="stringliteral">"[toggle]&lt;/A&gt;&lt;/TD&gt;&lt;/TR&gt;"</span>
00350          &lt;&lt; <span class="stringliteral">"&lt;/TABLE&gt;"</span>;
00351   }
00352   <span class="keywordflow">catch</span>( std::exception&amp; e )
00353   {
00354     body &lt;&lt; e.what();
00355   }
00356 
00357   <a class="code" href="_call_stack_8h.html#a1">QF_STACK_POP</a>
00358 }
00359 
00360 <span class="keywordtype">void</span> HttpConnection::processResetSession
<a name="l00361"></a><a class="code" href="class_f_i_x_1_1_http_connection.html#d5">00361</a> ( <span class="keyword">const</span> <a class="code" href="class_f_i_x_1_1_http_message.html">HttpMessage</a>&amp; request, std::stringstream&amp; header, std::stringstream&amp; body )
00362 { <a class="code" href="_call_stack_8h.html#a0">QF_STACK_PUSH</a>(HttpConnection::processResetSession)
00363 
00364   <span class="keywordflow">try</span>
00365   {
00366     <a class="code" href="class_f_i_x_1_1_http_message.html">HttpMessage</a> copy = request;
00367     std::string beginString = request.<a class="code" href="class_f_i_x_1_1_http_message.html#a11">getParameter</a>( <span class="stringliteral">"BeginString"</span> );
00368     std::string senderCompID = request.<a class="code" href="class_f_i_x_1_1_http_message.html#a11">getParameter</a>( <span class="stringliteral">"SenderCompID"</span> );
00369     std::string targetCompID = request.<a class="code" href="class_f_i_x_1_1_http_message.html#a11">getParameter</a>( <span class="stringliteral">"TargetCompID"</span> );
00370     std::string sessionQualifier;
00371         <span class="keywordflow">if</span>( copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a10">hasParameter</a>(<span class="stringliteral">"SessionQualifier"</span>) )
00372                 sessionQualifier = copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a11">getParameter</a>( <span class="stringliteral">"SessionQualifier"</span> );
00373 
00374         <a class="code" href="class_f_i_x_1_1_session_i_d.html">SessionID</a> sessionID( beginString, senderCompID, targetCompID, sessionQualifier );
00375     <a class="code" href="class_f_i_x_1_1_session.html">Session</a>* pSession = Session::lookupSession( sessionID );
00376     <span class="keywordflow">if</span>( pSession == 0 ) <span class="keywordflow">throw</span> <a class="code" href="struct_f_i_x_1_1_session_not_found.html">SessionNotFound</a>();
00377 
00378     std::string sessionUrl = <span class="stringliteral">"/session"</span> + request.<a class="code" href="class_f_i_x_1_1_http_message.html#a8">getParameterString</a>();
00379 
00380     <span class="keywordtype">bool</span> confirm = <span class="keyword">false</span>;
00381     <span class="keywordflow">if</span>( copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a10">hasParameter</a>(<span class="stringliteral">"confirm"</span>) &amp;&amp; IntConvertor::convert(copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a11">getParameter</a>(<span class="stringliteral">"confirm"</span>)) )
00382     {
00383       confirm = <span class="keyword">true</span>;
00384       pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a9">reset</a>();
00385       copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a13">removeParameter</a>(<span class="stringliteral">"confirm"</span>);
00386     }
00387 
00388     <span class="keywordflow">if</span>( confirm )
00389     {
00390       header &lt;&lt; <span class="stringliteral">"&lt;META http-equiv='refresh' content=2;URL='"</span> &lt;&lt; <span class="stringliteral">"/session"</span> &lt;&lt; copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a8">getParameterString</a>() &lt;&lt; <span class="stringliteral">"'&gt;"</span>;
00391       body &lt;&lt; <span class="stringliteral">"&lt;CENTER&gt;&lt;H2&gt;&lt;A href='"</span> &lt;&lt; <span class="stringliteral">"/session"</span> &lt;&lt; copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a8">getParameterString</a>() &lt;&lt; <span class="stringliteral">"'&gt;"</span> 
00392            &lt;&lt; sessionID &lt;&lt; <span class="stringliteral">"&lt;/A&gt; has been reset&lt;/H2&gt;&lt;/CENTER&gt;"</span>;
00393     }
00394     <span class="keywordflow">else</span>
00395     {
00396       body &lt;&lt; <span class="stringliteral">"&lt;CENTER&gt;&lt;H2&gt;Are you sure you want to reset session &lt;A href='"</span> &lt;&lt; sessionUrl 
00397            &lt;&lt; request.<a class="code" href="class_f_i_x_1_1_http_message.html#a8">getParameterString</a>() &lt;&lt; <span class="stringliteral">"'&gt;"</span> &lt;&lt; sessionID &lt;&lt; <span class="stringliteral">"&lt;/A&gt;?&lt;/H2&gt;&lt;/CENTER&gt;"</span>
00398            &lt;&lt; <span class="stringliteral">"&lt;CENTER&gt;[&lt;A HREF='"</span> &lt;&lt; request.<a class="code" href="class_f_i_x_1_1_http_message.html#a3">toString</a>() + <span class="stringliteral">"&amp;confirm=1'&gt;YES, reset session&lt;/A&gt;]"</span>
00399            &lt;&lt; <span class="stringliteral">"&amp;nbsp;[&lt;A HREF='"</span> &lt;&lt; sessionUrl &lt;&lt; <span class="stringliteral">"'&gt;NO, do not reset session&lt;/A&gt;]"</span>
00400            &lt;&lt; <span class="stringliteral">"&lt;/CENTER&gt;"</span>;
00401     }
00402   }
00403   <span class="keywordflow">catch</span>( std::exception&amp; e )
00404   {
00405     body &lt;&lt; e.what();
00406   }
00407 
00408   <a class="code" href="_call_stack_8h.html#a1">QF_STACK_POP</a>
00409 }
00410 
00411 <span class="keywordtype">void</span> HttpConnection::processRefreshSession
<a name="l00412"></a><a class="code" href="class_f_i_x_1_1_http_connection.html#d6">00412</a> ( <span class="keyword">const</span> <a class="code" href="class_f_i_x_1_1_http_message.html">HttpMessage</a>&amp; request, std::stringstream&amp; header, std::stringstream&amp; body )
00413 { <a class="code" href="_call_stack_8h.html#a0">QF_STACK_PUSH</a>(HttpConnection::processRefreshSession)
00414 
00415   <span class="keywordflow">try</span>
00416   {
00417     <a class="code" href="class_f_i_x_1_1_http_message.html">HttpMessage</a> copy = request;
00418     std::string beginString = request.<a class="code" href="class_f_i_x_1_1_http_message.html#a11">getParameter</a>( <span class="stringliteral">"BeginString"</span> );
00419     std::string senderCompID = request.<a class="code" href="class_f_i_x_1_1_http_message.html#a11">getParameter</a>( <span class="stringliteral">"SenderCompID"</span> );
00420     std::string targetCompID = request.<a class="code" href="class_f_i_x_1_1_http_message.html#a11">getParameter</a>( <span class="stringliteral">"TargetCompID"</span> );
00421     std::string sessionQualifier;
00422         <span class="keywordflow">if</span>( copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a10">hasParameter</a>(<span class="stringliteral">"SessionQualifier"</span>) )
00423                 sessionQualifier = copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a11">getParameter</a>( <span class="stringliteral">"SessionQualifier"</span> );
00424 
00425         <a class="code" href="class_f_i_x_1_1_session_i_d.html">SessionID</a> sessionID( beginString, senderCompID, targetCompID, sessionQualifier );
00426     <a class="code" href="class_f_i_x_1_1_session.html">Session</a>* pSession = Session::lookupSession( sessionID );
00427     <span class="keywordflow">if</span>( pSession == 0 ) <span class="keywordflow">throw</span> <a class="code" href="struct_f_i_x_1_1_session_not_found.html">SessionNotFound</a>();
00428 
00429     std::string sessionUrl = <span class="stringliteral">"/session"</span> + request.<a class="code" href="class_f_i_x_1_1_http_message.html#a8">getParameterString</a>();
00430 
00431     <span class="keywordtype">bool</span> confirm = <span class="keyword">false</span>;
00432     <span class="keywordflow">if</span>( copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a10">hasParameter</a>(<span class="stringliteral">"confirm"</span>) &amp;&amp; IntConvertor::convert(copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a11">getParameter</a>(<span class="stringliteral">"confirm"</span>)) )
00433     {
00434       confirm = <span class="keyword">true</span>;
00435       pSession-&gt;<a class="code" href="class_f_i_x_1_1_session.html#a10">refresh</a>();
00436       copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a13">removeParameter</a>(<span class="stringliteral">"confirm"</span>);
00437     }
00438 
00439     <span class="keywordflow">if</span>( confirm )
00440     {
00441       header &lt;&lt; <span class="stringliteral">"&lt;META http-equiv='refresh' content=2;URL='"</span> &lt;&lt; <span class="stringliteral">"/session"</span> &lt;&lt; copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a8">getParameterString</a>() &lt;&lt; <span class="stringliteral">"'&gt;"</span>;
00442       body &lt;&lt; <span class="stringliteral">"&lt;CENTER&gt;&lt;H2&gt;&lt;A href='"</span> &lt;&lt; <span class="stringliteral">"/session"</span> &lt;&lt; copy.<a class="code" href="class_f_i_x_1_1_http_message.html#a8">getParameterString</a>() &lt;&lt; <span class="stringliteral">"'&gt;"</span> 
00443            &lt;&lt; sessionID &lt;&lt; <span class="stringliteral">"&lt;/A&gt; has been refreshed&lt;/H2&gt;&lt;/CENTER&gt;"</span>;
00444     }
00445     <span class="keywordflow">else</span>
00446     {
00447       body &lt;&lt; <span class="stringliteral">"&lt;CENTER&gt;&lt;H2&gt;Are you sure you want to refresh session &lt;A href='"</span> &lt;&lt; sessionUrl 
00448            &lt;&lt; request.<a class="code" href="class_f_i_x_1_1_http_message.html#a8">getParameterString</a>() &lt;&lt; <span class="stringliteral">"'&gt;"</span> &lt;&lt; sessionID &lt;&lt; <span class="stringliteral">"&lt;/A&gt;?&lt;/H2&gt;&lt;/CENTER&gt;"</span>
00449            &lt;&lt; <span class="stringliteral">"&lt;CENTER&gt;[&lt;A HREF='"</span> &lt;&lt; request.<a class="code" href="class_f_i_x_1_1_http_message.html#a3">toString</a>() + <span class="stringliteral">"&amp;confirm=1'&gt;YES, refresh session&lt;/A&gt;]"</span>
00450            &lt;&lt; <span class="stringliteral">"&amp;nbsp;[&lt;A HREF='"</span> &lt;&lt; sessionUrl &lt;&lt; <span class="stringliteral">"'&gt;NO, do not refresh session&lt;/A&gt;]"</span>
00451            &lt;&lt; <span class="stringliteral">"&lt;/CENTER&gt;"</span>;
00452     }
00453   }
00454   <span class="keywordflow">catch</span>( std::exception&amp; e )
00455   {
00456     body &lt;&lt; e.what();
00457   }
00458 
00459   <a class="code" href="_call_stack_8h.html#a1">QF_STACK_POP</a>
00460 }
00461 
00462 } <span class="comment">// namespace FIX</span>
</pre></div><hr><address><small>
Generated on Thu Sep 14 08:52:35 2006 for QuickFIX by <a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 width=110 height=53>
</a> 1.3.6-20040222 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
